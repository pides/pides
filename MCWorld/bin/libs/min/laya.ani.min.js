!function(t,i,e){var a=(e.un,e.uns,e["static"]),s=e["class"],r=e.getset,n=e.__newvec,h=(laya.resource.Bitmap,laya.utils.Browser),l=laya.utils.Byte,o=(laya.events.Event,laya.events.EventDispatcher),u=laya.display.Graphics,c=laya.utils.Handler,_=laya.net.Loader,p=laya.maths.MathUtil,d=laya.maths.Matrix,f=laya.renders.Render,x=laya.utils.RunDriver,m=laya.display.Sprite,g=laya.utils.Stat,y=laya.resource.Texture,M=laya.net.URL,v=(function(){function t(){}return s(t,"laya.ani.AnimationState"),t.stopped=0,t.paused=1,t.playing=2,t}(),function(){function t(){this.name=null,this._parent=null,this.length=10,this.transform=null,this.sprite=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this._children=[],this.resultTransform=new P,this.resultMatrix=new d}s(t,"laya.ani.bone.Bone");var i=t.prototype;return i.update=function(t){this.rotation=this.transform.skX;var i;if(t)i=this.resultTransform.getMatrix(),d.mul(i,t,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this._parent.resultRotation,this._parent)if(this.inheritRotation&&this.inheritScale)i=this.resultTransform.getMatrix(),d.mul(i,this._parent.resultMatrix,this.resultMatrix);else{var e=(this.transform.getMatrix().a,this.transform.getMatrix().b,this.transform.getMatrix().c,this.transform.getMatrix().d,this._parent),a=NaN,s=NaN,r=NaN,n=this._parent.resultMatrix,h=n.a*this.transform.x+n.b*this.transform.y+n.tx,l=n.c*this.transform.x+n.d*this.transform.y+n.ty,o=new d;if(this.inheritRotation){a=Math.atan2(e.resultMatrix.c,e.resultMatrix.a),s=Math.cos(a),r=Math.sin(a),o.setTo(s,r,-r,s,0,0);var u=new d(1,0,0,-1);d.mul(u,o,d.TEMP),d.TEMP.copyTo(o),i=this.resultTransform.getMatrix(),d.mul(i,o,this.resultMatrix),this.resultMatrix.tx=h,this.resultMatrix.ty=l}else this.inheritScale?(i=this.resultTransform.getMatrix(),d.TEMP.identity(),d.TEMP.d=-1,d.mul(i,d.TEMP,this.resultMatrix),this.resultMatrix.tx=h,this.resultMatrix.ty=l):(i=this.resultTransform.getMatrix(),d.TEMP.identity(),d.TEMP.d=-1,d.mul(i,d.TEMP,this.resultMatrix),this.resultMatrix.tx=h,this.resultMatrix.ty=l)}else i=this.resultTransform.getMatrix(),i.copyTo(this.resultMatrix);var c,_=0,p=0;for(_=0,p=this._children.length;p>_;_++)c=this._children[_],c.update()},i.updateChild=function(){var t,i=0,e=0;for(i=0,e=this._children.length;e>i;i++)t=this._children[i],t.update()},i.updateDraw=function(t,i){this.sprite?(this.sprite.x=t+this.resultMatrix.tx,this.sprite.y=i+this.resultMatrix.ty):(this.sprite=new m,this.sprite.graphics.drawCircle(0,0,5,"#ff0000"),this.sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),e.stage.addChild(this.sprite),this.sprite.x=t+this.resultMatrix.tx,this.sprite.y=i+this.resultMatrix.ty);var a,s=0,r=0;for(s=0,r=this._children.length;r>s;s++)a=this._children[s],a.updateDraw(t,i)},i.addChild=function(t){this._children.push(t),t._parent=this},i.findBone=function(t){if(this.name==t)return this;var i,e,a=0,s=0;for(a=0,s=this._children.length;s>a;a++)if(i=this._children[a],e=i.findBone(t))return e;return null},i.localToWorld=function(t){var i=t[0],e=t[1];t[0]=i*this.resultMatrix.a+e*this.resultMatrix.c+this.resultMatrix.tx,t[1]=i*this.resultMatrix.b+e*this.resultMatrix.d+this.resultMatrix.ty},t}()),D=function(){function t(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null}s(t,"laya.ani.bone.BoneSlot");var i=t.prototype;return i.showSlotData=function(t){this.currSlotData=t,this.displayIndex=this.srcDisplayIndex,this.currDisplayData=null,this.currTexture=null},i.showDisplayByName=function(t){this.showDisplayByIndex(this.currSlotData.getDisplayByName(t))},i.showDisplayByIndex=function(t){if(this.currSlotData&&t>-1&&t<this.currSlotData.displayArr.length){if(this.displayIndex=t,this.currDisplayData=this.currSlotData.displayArr[t],this.currDisplayData){var i=this.currDisplayData.name;this.currTexture=this.templet.getTexture(i),this.currTexture&&f.isWebGL&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(this.currTexture=new y(this.currTexture.bitmap,this.currDisplayData.uvs),this.currTexture.bitmap.useNum--)}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},i.replaceSkin=function(t){this._diyTexture=t},i.setParentMatrix=function(t){this._parentMatrix=t},i.draw=function(t,i,e){if(void 0===e&&(e=!1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var a=this.currTexture;this._diyTexture&&(a=this._diyTexture);var s;switch(this.currDisplayData.type){case 0:if(t){var r=this.getDisplayMatrix();if(this._parentMatrix){var n=!1;if(r){d.mul(r,this._parentMatrix,d.TEMP);var h;if(e?(null==this._resultMatrix&&(this._resultMatrix=new d),h=this._resultMatrix):h=new d,!f.isWebGL&&this.currDisplayData.uvs){var l=new d(1,0,0,1);this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(l.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(n=!0,l.rotate(-Math.PI/2)),d.mul(l,d.TEMP,h)}else d.TEMP.copyTo(h);n?t.drawTexture(a,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,h):t.drawTexture(a,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,h)}}}break;case 1:if(s=x.skinAniSprite(),null==s)return;t.drawSkin(s);var o=[],u=[],c=1,_=1,p=1,m=1;if(null==this.currDisplayData.bones){for(var g=0,y=0;g<this.currDisplayData.weights.length&&y<this.currDisplayData.uvs.length;){var M=this.currDisplayData.weights[g++],v=this.currDisplayData.weights[g++];o.push(M,v,this.currDisplayData.uvs[y++],this.currDisplayData.uvs[y++],c,_,p,m)}var D=this.currDisplayData.triangles.length/3;for(g=0;D>g;g++)u.push(this.currDisplayData.triangles[3*g]),u.push(this.currDisplayData.triangles[3*g+1]),u.push(this.currDisplayData.triangles[3*g+2]);s.init(this.currTexture,o,u);var I=this.getDisplayMatrix();if(this._parentMatrix&&I){d.mul(I,this._parentMatrix,d.TEMP);var N;e?(null==this._resultMatrix&&(this._resultMatrix=new d),N=this._resultMatrix):N=new d,d.TEMP.copyTo(N),s.transform=N}}else this.skinMesh(i,s);break;case 2:if(s=x.skinAniSprite(),null==s)return;t.drawSkin(s),this.skinMesh(i,s);break;case 3:}}},i.skinMesh=function(t,i){var e,a=this.currDisplayData.bones,s=this.currDisplayData.uvs,r=this.currDisplayData.weights,n=this.currDisplayData.triangles,h=[],l=[],o=0,u=0,c=0,_=NaN,p=NaN,d=0,f=0,x=[],m=0,g=0,y=0,M=1,v=1,D=1,I=1;for(m=0,y=a.length;y>m;){for(c=a[m++]+m,o=0,u=0;c>m;m++)e=t[a[m]],_=r[d],p=r[d+1],f=r[d+2],o+=(_*e.a+p*e.c+e.tx)*f,u+=(_*e.b+p*e.d+e.ty)*f,d+=3;x.push(o,u)}for(m=0,g=0;m<x.length&&g<s.length;)o=x[m++],u=x[m++],h.push(o,u,s[g++],s[g++],M,v,D,I);for(m=0,y=n.length;y>m;m++)l.push(n[m]);i.init(this.currTexture,h,l)},i.drawBonePoint=function(t){t&&this._parentMatrix&&t.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},i.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},i.getMatrix=function(){return this._resultMatrix},i.copy=function(){var i=new t;return i.type="copy",i.name=this.name,i.attachmentName=this.attachmentName,i.srcDisplayIndex=this.srcDisplayIndex,i.parent=this.parent,i.displayIndex=this.displayIndex,i.templet=this.templet,i.currSlotData=this.currSlotData,i.currTexture=this.currTexture,i.currDisplayData=this.currDisplayData,i},t}(),I=function(){function t(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return s(t,"laya.ani.bone.EventData"),t}(),N=function(){function t(t,i){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this._data=t,this._targetBone=i[t.targetBoneIndex],null==this._bones&&(this._bones=[]),this._bones.length=0;for(var e=0,a=t.boneIndexs.length;a>e;e++)this._bones.push(i[t.boneIndexs[e]]);this.name=t.name,this.mix=t.mix,this.bendDirection=t.bendDirection}s(t,"laya.ani.bone.IkConstraint");var i=t.prototype;return i.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},i._applyIk1=function(i,e,a,s){var r=i._parent,n=1/(r.resultMatrix.a*r.resultMatrix.d-r.resultMatrix.b*r.resultMatrix.c),h=e-r.resultMatrix.tx,l=a-r.resultMatrix.ty,o=(h*r.resultMatrix.d-l*r.resultMatrix.b)*n-i.transform.x,u=(l*r.resultMatrix.a-h*r.resultMatrix.c)*n-i.transform.y,c=Math.atan2(u,o)*t.radDeg-0-i.transform.skX;i.transform.scX<0&&(c+=180),c>180?c-=360:-180>c&&(c+=360),i.transform.skX=i.transform.skY=i.transform.skX+c*s,i.update()},i._applyIk2=function(i,e,a,s,r,n){if(0!=n){var h=i.transform.x,l=i.transform.y,o=i.transform.scX,u=i.transform.scY,c=e.transform.scX,_=0,p=0,d=0;0>o?(o=-o,_=180,d=-1):(_=0,d=1),0>u&&(u=-u,d=-d),0>c?(c=-c,p=180):p=0;var f=e.transform.x,x=NaN,m=NaN,g=NaN,y=i.resultMatrix.a,M=i.resultMatrix.b,v=i.resultMatrix.c,D=i.resultMatrix.d,I=Math.abs(o-u)<=1e-4;I?(x=e.resultTransform.y,m=y*f+M*x+i.resultMatrix.tx,g=v*f+D*x+i.resultMatrix.ty):(x=0,m=y*f+i.resultMatrix.tx,g=v*f+i.resultMatrix.ty);var N=i._parent;y=N.resultMatrix.a,M=N.resultMatrix.b,v=N.resultMatrix.c,D=N.resultMatrix.d;var b=1/(y*D-M*v),A=a-N.resultMatrix.tx,T=s-N.resultMatrix.ty,F=(A*D-T*M)*b-h,C=(T*y-A*v)*b-l;A=m-N.resultMatrix.tx,T=g-N.resultMatrix.ty;var S=(A*D-T*M)*b-h,k=(T*y-A*v)*b-l,w=Math.sqrt(S*S+k*k),P=e.length*c,U=NaN,B=NaN;if(I){P*=o;var L=(F*F+C*C-w*w-P*P)/(2*w*P);-1>L?L=-1:L>1&&(L=1),B=Math.acos(L)*r,y=w+P*L,M=P*Math.sin(B),U=Math.atan2(C*y-F*M,F*y+C*M)}else{y=o*P,M=u*P;var R=y*y,E=M*M,O=F*F+C*C,Y=Math.atan2(C,F);v=E*w*w+R*O-R*E;var X=-2*E*w,W=E-R;if(D=X*X-4*W*v,D>0){var K=Math.sqrt(D);0>X&&(K=-K),K=-(X+K)/2;var V=K/W,q=v/K,G=Math.abs(V)<Math.abs(q)?V:q;O>=G*G&&(T=Math.sqrt(O-G*G)*r,U=Y-Math.atan2(T,G),B=Math.atan2(T/u,(G-w)/o))}var z=0,Q=Number.MAX_VALUE,Z=0,$=0,j=0,H=0,J=0,tt=0;A=w+y,D=A*A,D>H&&(j=0,H=D,J=A),A=w-y,D=A*A,Q>D&&(z=Math.PI,Q=D,Z=A);var it=Math.acos(-y*w/(R-E));A=y*Math.cos(it)+w,T=M*Math.sin(it),D=A*A+T*T,Q>D&&(z=it,Q=D,Z=A,$=T),D>H&&(j=it,H=D,J=A,tt=T),(Q+H)/2>=O?(U=Y-Math.atan2($*r,Z),B=z*r):(U=Y-Math.atan2(tt*r,J),B=j*r)}var et=Math.atan2(x,f)*d,at=i.transform.skX;U=(U-et)*t.radDeg+_-at,U>180?U-=360:-180>U&&(U+=360),i.resultTransform.x=h,i.resultTransform.y=l,i.resultTransform.skX=i.resultTransform.skY=at+U*n,at=e.transform.skX,at%=360,B=((B+et)*t.radDeg-0)*d+p-at,B>180?B-=360:-180>B&&(B+=360),e.resultTransform.x=f,e.resultTransform.y=x,e.resultTransform.skX=e.resultTransform.skY=e.resultTransform.skY+B*n,i.update()}},a(t,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180}]),t}(),b=function(){function t(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return s(t,"laya.ani.bone.IkConstraintData"),t}(),A=function(){function t(t,i){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=t,this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.bones=[];for(var e=this.data.bones,a=0,s=e.length;s>a;a++)this.bones.push(i[e[a]])}s(t,"laya.ani.bone.PathConstraint");var i=t.prototype;return i.apply=function(t,i){var e=this.translateMix,a=this.translateMix,s=a>0,r=this.data.spacingMode,n="length"==r,h=this.data.rotateMode,l="tangent"==h,o="chainScale"==h,u=[],c=this.bones.length,_=l?c:c+1,p=[];this._spaces=p,p[0]=this.position;var d=this.spacing;if(o||n)for(var f=0,x=_-1;x>f;){var m=this.bones[f],g=m.length,y=g*m.transform.getMatrix().a,M=g*m.transform.getMatrix().c;g=Math.sqrt(y*y+M*M),o&&(u[f]=g),p[++f]=n?Math.max(0,g+d):d}else for(f=1;_>f;f++)p[f]=d;var v=this.computeWorldPositions(this.target,t,i,_,l,"percent"==this.data.positionMode,"percent"==r);if(this._debugKey){for(f=0;f<v.length;f++)i.drawCircle(v[f++],v[f++],5,"#00ff00");var D=[];for(f=0;f<v.length;f++)D.push(v[f++],v[f++]);i.drawLines(0,0,D,"#ff0000")}var I=v[0],N=v[1],b=this.data.offsetRotation,A="chain"==h&&0==b,T=NaN;for(f=0,T=3;c>f;f++,T+=3){m=this.bones[f],m.resultMatrix.tx+=(I-m.resultMatrix.tx)*e,m.resultMatrix.ty+=(N-m.resultMatrix.ty)*e,y=v[T],M=v[T+1];var F=y-I,C=M-N;if(o&&(g=u[f],0!=g)){var S=(Math.sqrt(F*F+C*C)/g-1)*a+1;m.resultMatrix.a*=S,m.resultMatrix.c*=S}if(I=y,N=M,s){var k=m.resultMatrix.a,w=m.resultMatrix.b,P=m.resultMatrix.c,U=m.resultMatrix.d,B=NaN,L=NaN,R=NaN;B=l?v[T-1]:0==p[f+1]?v[T+2]:Math.atan2(C,F),B-=Math.atan2(P,k)-b/180*Math.PI,A&&(L=Math.cos(B),R=Math.sin(B),g=m.length,I+=(g*(L*k-R*P)-F)*a,N+=(g*(R*k+L*P)-C)*a),B>Math.PI?B-=2*Math.PI:B<-Math.PI&&(B+=2*Math.PI),B*=a,L=Math.cos(B),R=Math.sin(B),m.resultMatrix.a=L*k-R*P,m.resultMatrix.c=L*w-R*U,m.resultMatrix.b=R*k+L*P,m.resultMatrix.d=R*w+L*U}}},i.computeWorldVertices2=function(t,i,e,a,s,r){var n,h=t.currDisplayData.bones,l=t.currDisplayData.weights,o=(t.currDisplayData.triangles,0),u=0,c=0,_=0,p=0,d=0,f=0,x=0,m=0,g=0;for(o=0;e>o;o+=2)_=h[u],u+=_+1,c+=_;var y=i;for(p=r,d=3*c;a>p;p+=2){for(f=0,x=0,_=h[u++],_+=u;_>u;u++,d+=3){n=y[h[u]].resultMatrix,m=l[d],g=l[d+1];var M=l[d+2];f+=(m*n.a+g*n.c+n.tx)*M,x+=(m*n.b+g*n.d+n.ty)*M}s[p]=f,s[p+1]=x}},i.computeWorldPositions=function(t,i,e,a,s,r,n){var h=(t.currDisplayData.bones,t.currDisplayData.weights,t.currDisplayData.triangles,[]),l=0,o=t.currDisplayData.verLen,u=this.position,c=this._spaces,_=[],p=[],d=!1,f=o/6,x=-1,m=NaN,g=0,y=0,M=NaN,v=NaN,D=NaN,I=NaN;if(d)o+=2,_[o-2]=_[0],_[o-1]=_[1];else{if(f--,o-=4,this.computeWorldVertices2(t,i,2,o,h,0),this._debugKey)for(l=0;l<h.length;)e.drawCircle(h[l++],h[l++],10,"#ff0000");_=h}this._curves.length=f;var N=this._curves;m=0;var b=_[0],A=_[1],T=0,F=0,C=0,S=0,k=0,w=0,P=NaN,U=NaN,B=NaN,L=NaN,R=NaN,E=NaN,O=NaN,Y=NaN,X=0;for(l=0,X=2;f>l;l++,X+=6)T=_[X],F=_[X+1],C=_[X+2],S=_[X+3],k=_[X+4],w=_[X+5],P=.1875*(b-2*T+C),U=.1875*(A-2*F+S),B=.09375*(3*(T-C)-b+k),L=.09375*(3*(F-S)-A+w),R=2*P+B,E=2*U+L,O=.75*(T-b)+P+.16666667*B,Y=.75*(F-A)+U+.16666667*L,m+=Math.sqrt(O*O+Y*Y),O+=R,Y+=E,R+=B,E+=L,m+=Math.sqrt(O*O+Y*Y),O+=R,Y+=E,m+=Math.sqrt(O*O+Y*Y),O+=R+B,Y+=E+L,m+=Math.sqrt(O*O+Y*Y),N[l]=m,b=k,A=w;if(r&&(u*=m),n)for(l=0;a>l;l++)c[l]*=m;var W=this._segments,K=0,V=0;for(l=0,g=0,y=0,V=0;a>l;l++,g+=3){if(v=c[l],u+=v,M=u,d)M%=m,0>M&&(M+=m),y=0;else{if(0>M){this.addBeforePosition(M,_,0,p,g);continue}if(M>m){this.addAfterPosition(M-m,_,o-4,p,g);continue}}for(;;y++)if(I=N[y],!(M>I)){0==y?M/=I:(D=N[y-1],M=(M-D)/(I-D));break}if(y!=x){x=y;var q=6*y;for(b=_[q],A=_[q+1],T=_[q+2],F=_[q+3],C=_[q+4],S=_[q+5],k=_[q+6],w=_[q+7],P=.03*(b-2*T+C),U=.03*(A-2*F+S),B=.006*(3*(T-C)-b+k),L=.006*(3*(F-S)-A+w),R=2*P+B,E=2*U+L,O=.3*(T-b)+P+.16666667*B,Y=.3*(F-A)+U+.16666667*L,K=Math.sqrt(O*O+Y*Y),W[0]=K,q=1;8>q;q++)O+=R,Y+=E,R+=B,E+=L,K+=Math.sqrt(O*O+Y*Y),W[q]=K;O+=R,Y+=E,K+=Math.sqrt(O*O+Y*Y),W[8]=K,O+=R+B,Y+=E+L,K+=Math.sqrt(O*O+Y*Y),W[9]=K,V=0}for(M*=K;;V++)if(I=W[V],!(M>I)){0==V?M/=I:(D=W[V-1],M=V+(M-D)/(I-D));break}this.addCurvePosition(.1*M,b,A,T,F,C,S,k,w,p,g,s||l>0&&0==v)}return p},i.addBeforePosition=function(t,i,e,a,s){var r=i[e],n=i[e+1],h=i[e+2]-r,l=i[e+3]-n,o=Math.atan2(l,h);a[s]=r+t*Math.cos(o),a[s+1]=n+t*Math.sin(o),a[s+2]=o},i.addAfterPosition=function(t,i,e,a,s){var r=i[e+2],n=i[e+3],h=r-i[e],l=n-i[e+1],o=Math.atan2(l,h);a[s]=r+t*Math.cos(o),a[s+1]=n+t*Math.sin(o),a[s+2]=o},i.addCurvePosition=function(t,i,e,a,s,r,n,h,l,o,u,c){0==t&&(t=1e-4);var _=t*t,p=_*t,d=1-t,f=d*d,x=f*d,m=d*t,g=3*m,y=d*g,M=g*t,v=i*x+a*y+r*M+h*p,D=e*x+s*y+n*M+l*p;o[u]=v,o[u+1]=D,c?o[u+2]=Math.atan2(D-(e*f+s*m*2+n*_),v-(i*f+a*m*2+r*_)):o[u+2]=0},t.NONE=-1,t.BEFORE=-2,t.AFTER=-3,t}(),T=function(){function t(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return s(t,"laya.ani.bone.PathConstraintData"),t}(),F=function(){function t(){this.name=null,this.slotArr=[]}return s(t,"laya.ani.bone.SkinData"),t}(),C=function(){function t(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}return s(t,"laya.ani.bone.SkinSlotDisplayData"),t}(),S=function(){function t(){this.name=null,this.displayArr=[]}s(t,"laya.ani.bone.SlotData");var i=t.prototype;return i.getDisplayByName=function(t){for(var i,e=0,a=this.displayArr.length;a>e;e++)if(i=this.displayArr[e],i.attachmentName==t)return e;return-1},t}(),k=function(){function t(t,i){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=n(2,0),this._data=t,null==this._bones&&(this._bones=[]),this.target=i[t.targetIndex];var e=0,a=0;for(e=0,a=t.boneIndexs.length;a>e;e++)this._bones.push(i[t.boneIndexs[e]]);this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix}s(t,"laya.ani.bone.TfConstraint");var i=t.prototype;return i.apply=function(){for(var t,i=this.target.resultMatrix.a,e=this.target.resultMatrix.b,a=this.target.resultMatrix.c,s=this.target.resultMatrix.d,r=0,n=this._bones.length;n>r;r++){if(t=this._bones[r],this.rotateMix>0){var h=t.resultMatrix.a,l=t.resultMatrix.b,o=t.resultMatrix.c,u=t.resultMatrix.d,c=Math.atan2(a,i)-Math.atan2(o,h)+this._data.offsetRotation*Math.PI/180;c>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c*=this.rotateMix;var _=Math.cos(c),p=Math.sin(c);t.resultMatrix.a=_*h-p*o,t.resultMatrix.b=_*l-p*u,t.resultMatrix.c=p*h+_*o,t.resultMatrix.d=p*l+_*u}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),t.resultMatrix.tx+=(this._temp[0]-t.resultMatrix.tx)*this.translateMix,t.resultMatrix.ty+=(this._temp[1]-t.resultMatrix.ty)*this.translateMix,t.updateChild()),this.scaleMix>0){var d=Math.sqrt(t.resultMatrix.a*t.resultMatrix.a+t.resultMatrix.c*t.resultMatrix.c),f=Math.sqrt(i*i+a*a),x=d>1e-5?(d+(f-d+this._data.offsetScaleX)*this.scaleMix)/d:0;t.resultMatrix.a*=x,t.resultMatrix.c*=x,d=Math.sqrt(t.resultMatrix.b*t.resultMatrix.b+t.resultMatrix.d*t.resultMatrix.d),f=Math.sqrt(e*e+s*s),x=d>1e-5?(d+(f-d+this._data.offsetScaleY)*this.scaleMix)/d:0,t.resultMatrix.b*=x,t.resultMatrix.d*=x}if(this.shearMix>0){l=t.resultMatrix.b,u=t.resultMatrix.d;var m=Math.atan2(u,l);c=Math.atan2(s,e)-Math.atan2(a,i)-(m-Math.atan2(t.resultMatrix.c,t.resultMatrix.a)),c>Math.PI?c-=2*Math.PI:c<-Math.PI&&(c+=2*Math.PI),c=m+(c+this._data.offsetShearY*Math.PI/180)*this.shearMix,x=Math.sqrt(l*l+u*u),t.resultMatrix.b=Math.cos(c)*x,t.resultMatrix.d=Math.sin(c)*x}}},t}(),w=function(){function t(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return s(t,"laya.ani.bone.TfConstraintData"),t}(),P=function(){function t(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.mMatrix=null}s(t,"laya.ani.bone.Transform");var i=t.prototype;return i.initData=function(t){void 0!=t.x&&(this.x=t.x),void 0!=t.y&&(this.y=t.y),void 0!=t.skX&&(this.skX=t.skX),void 0!=t.skY&&(this.skY=t.skY),void 0!=t.scX&&(this.scX=t.scX),void 0!=t.scY&&(this.scY=t.scY)},i.getMatrix=function(){var t;if(t=this.mMatrix?this.mMatrix:this.mMatrix=new d,t.a=Math.cos(this.skY),0!=this.skX||0!=this.skY){var i=this.skX*Math.PI/180,e=Math.cos(i),a=Math.sin(i);t.setTo(this.scX*e,this.scX*a,this.scY*-a,this.scY*e,this.x,this.y)}else t.setTo(this.scX,this.skX,this.skY,this.scY,this.x,this.y);return t},t}(),U=function(t){function i(t){this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startPlayLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this.playbackRate=1,this.isCache=!0,this.returnToZeroStopped=!0,i.__super.call(this),void 0===t&&(t=60),this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startPlayLoopCount=-1,this._cacheFrameRate=t,this._cacheFrameRateInterval=1e3/this._cacheFrameRate}s(i,"laya.ani.AnimationPlayer",t);var e=i.prototype;return e._calculatePlayDuration=function(){if(0!==this.state){var t=this._templet.getAniDuration(this._currentAnimationClipIndex);if(0===this._playEnd&&(this._playEnd=t),Math.floor(this._playEnd)>t)throw new Error("AnimationPlayer:playEnd must less than original Duration.");this._playDuration=this._playEnd-this._playStart}},e.play=function(t,i,e,a,s){if(void 0===t&&(t=0),void 0===i&&(i=1),void 0===e&&(e=Number.MAX_VALUE),void 0===a&&(a=0),void 0===s&&(s=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(0>e||0>a||0>s)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==s&&a>s)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=i,this._overallDuration=e,this._playStart=a,this._playEnd=s,this._paused=!1,this._currentAnimationClipIndex=t,this._currentKeyframeIndex=0,this._startPlayLoopCount=g.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._calculatePlayDuration)},e.playByFrame=function(t,i,e,a,s,r){void 0===t&&(t=0),void 0===i&&(i=1),void 0===e&&(e=Number.MAX_VALUE),void 0===a&&(a=0),void 0===s&&(s=0),void 0===r&&(r=30);var n=1e3/r;this.play(t,i,e,a*n,s*n)},e.stop=function(t){void 0===t&&(t=!0),t?(this._currentAnimationClipIndex=this._currentKeyframeIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},e.update=function(t){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var i=0;this._startPlayLoopCount!==g.loopCount&&(i=t*this.playbackRate,this._elapsedPlaybackTime+=i);var e=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=e)return this._currentAnimationClipIndex=this._currentKeyframeIndex=-1,void this.event("stopped");if(i+=this._currentTime,e>0){for(;i>=e;){if(this._stopWhenCircleFinish)return this._currentAnimationClipIndex=this._currentKeyframeIndex=-1,this._stopWhenCircleFinish=!1,void this.event("stopped");i-=e}this._currentTime=i,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/this._cacheFrameRateInterval),this._currentFrameTime=this._currentKeyframeIndex*this._cacheFrameRateInterval}else{if(this._stopWhenCircleFinish)return this._currentAnimationClipIndex=this._currentKeyframeIndex=-1,this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0}}},r(0,e,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),r(0,e,"templet",function(){return this._templet},function(t){0===!this.state&&this.stop(!0),this._templet=t}),r(0,e,"currentPlayTime",function(){return this._currentTime+this._playStart}),r(0,e,"playStart",function(){return this._playStart}),r(0,e,"playEnd",function(){return this._playEnd}),r(0,e,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),r(0,e,"playDuration",function(){return this._playDuration}),r(0,e,"cacheFrameRate",function(){return this._cacheFrameRate}),r(0,e,"currentFrameTime",function(){return this._currentFrameTime}),r(0,e,"currentTime",null,function(t){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(t<this._playStart||t>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._currentTime=t,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/this._cacheFrameRateInterval),this._currentFrameTime=this._currentKeyframeIndex*this._cacheFrameRateInterval}}),r(0,e,"overallDuration",function(){return this._overallDuration}),r(0,e,"paused",function(){return this._paused},function(t){this._paused=t,t&&this.event("paused")}),r(0,e,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),r(0,e,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),i}(o),B=function(t){function i(){this._aniMap={},this.unfixedLastAniIndex=-1,this._loaded=!1,this._animationDatasCache=[],i.__super.call(this),this._anis=new Array}s(i,"laya.ani.KeyframesAniTemplet",t);var e=i.prototype;return e.parse=function(t,e){var a=0,s=0,r=0,n=0,h=0,o=new l(t);this._aniVersion=o.readUTFString();var u,c=(o.readUTFString(),o.readUTFString().split("\n")),_=o.getUint8(),p=o.getUint32(),d=o.getUint32();p>0&&(u=t.slice(p,d));var f=new l(u);for(d>0&&(this._publicExtData=t.slice(d,t.byteLength)),this._useParent=!!o.getUint8(),this._anis.length=_,a=0;_>a;a++){var x=this._anis[a]={};x.nodes=new Array;var m=x.name=c[o.getUint16()];this._aniMap[m]=a,x.bone3DMap={},x.playTime=o.getFloat32();var g=x.nodes.length=o.getUint8();for(x.totalKeyframesLength=0,s=0;g>s;s++){var y=x.nodes[s]={};y.childs=[];var M=o.getInt16();M>=0&&(y.name=c[M],x.bone3DMap[y.name]=s),y.keyFrame=new Array,y.parentIndex=o.getInt16(),-1==y.parentIndex?y.parent=null:y.parent=x.nodes[y.parentIndex];var v=!!o.getUint8(),D=o.getUint32();f.pos=D;var I=y.keyframeWidth=f.getUint16();if(x.totalKeyframesLength+=I,v)for(y.interpolationMethod=[],y.interpolationMethod.length=I,r=0;I>r;r++)y.interpolationMethod[r]=i.interpolation[f.getUint8()];null!=y.parent&&y.parent.childs.push(y);var N=o.getUint16();N>0&&(y.extenData=t.slice(o.pos,o.pos+N),o.pos+=N);var b=o.getUint16();y.keyFrame.length=b;var A=0;for(r=0,n=b;n>r;r++){var T=y.keyFrame[r]={};for(T.duration=o.getFloat32(),T.startTime=A,T.data=new Float32Array(I),T.dData=new Float32Array(I),T.nextData=new Float32Array(I),h=0;I>h;h++)T.data[h]=o.getFloat32(),T.data[h]>-1e-8&&T.data[h]<1e-8&&(T.data[h]=0);A+=T.duration}y.playTime=x.playTime,this._calculateKeyFrame(y,b,I),this._calculateKeyFrameIndex(y,e)}}this._loaded=!0,this.event("loaded",this)},e._calculateKeyFrame=function(t,i,e){var a=t.keyFrame;a[i]=a[0];for(var s=0;i>s;s++)for(var r=a[s],n=0;e>n;n++)r.dData[n]=0===r.duration?0:(a[s+1].data[n]-r.data[n])/r.duration,r.nextData[n]=a[s+1].data[n];a.length--},e._calculateKeyFrameIndex=function(t,i){var e=1e3/i;t.frameCount=Math.floor(t.playTime/e),t.fullFrame=new Uint16Array(t.frameCount+1);for(var a=-1,s=0,r=t.keyFrame.length;r>s;s++){var n=t.keyFrame[s],h=n.startTime,l=h+n.duration+e;do{for(var o=Math.floor(h/e+.5),u=a+1;o>u;u++)t.fullFrame[u]=s;a=o,t.fullFrame[o]=s,h+=e}while(l>=h)}},e.getAnimationCount=function(){return this._anis.length},e.getAnimation=function(t){return this._anis[t]},e.getAniDuration=function(t){return this._anis[t].playTime},e.getNodes=function(t){return this._anis[t].nodes},e.getNodeIndexWithName=function(t,i){return this._anis[t].bone3DMap[i]},e.getNodeCount=function(t){return this._anis[t].nodes.length},e.getTotalkeyframesLength=function(t){return this._anis[t].totalKeyframesLength},e.getPublicExtData=function(){return this._publicExtData},e.getAnimationDataWithCache=function(t,i,e){var a=t[i];return a?a[e]:null},e.setAnimationDataWithCache=function(t,i,e,a){var s=t[i];s||(s=t[i]=[]),s[e]=a},e.getOriginalData=function(t,i,e,a){for(var s=this._anis[t],r=s.nodes,n=0,h=0,l=r.length,o=0;l>h;h++){var u,c=r[h];u=c.keyFrame[c.fullFrame[e]],c.dataOffset=o;var _=a-u.startTime;for(n=0;n<c.keyframeWidth;)n+=c.interpolationMethod[n](c,n,i,o+n,u.data,_,u.dData,u.duration,u.nextData);o+=c.keyframeWidth}},e.getNodesCurrentFrameIndex=function(t,i){var e=this._anis[t],a=e.nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(a.length),this.unfixedCurrentTimes=new Float32Array(a.length),this.unfixedLastAniIndex=t);for(var s=0,r=a.length;r>s;s++){var n=a[s];for(i<this.unfixedCurrentTimes[s]&&(this.unfixedCurrentFrameIndexes[s]=0),this.unfixedCurrentTimes[s]=i;this.unfixedCurrentFrameIndexes[s]<n.keyFrame.length&&!(n.keyFrame[this.unfixedCurrentFrameIndexes[s]].startTime>this.unfixedCurrentTimes[s]);)this.unfixedCurrentFrameIndexes[s]++;this.unfixedCurrentFrameIndexes[s]--}return this.unfixedCurrentFrameIndexes},e.getOriginalDataUnfixedRate=function(t,i,e){var a=this._anis[t],s=a.nodes;t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(s.length),this.unfixedCurrentTimes=new Float32Array(s.length),this.unfixedKeyframes=n(s.length),this.unfixedLastAniIndex=t);for(var r=0,h=0,l=s.length,o=0;l>h;h++){var u=s[h];for(e<this.unfixedCurrentTimes[h]&&(this.unfixedCurrentFrameIndexes[h]=0),this.unfixedCurrentTimes[h]=e;this.unfixedCurrentFrameIndexes[h]<u.keyFrame.length&&!(u.keyFrame[this.unfixedCurrentFrameIndexes[h]].startTime>this.unfixedCurrentTimes[h]);)this.unfixedKeyframes[h]=u.keyFrame[this.unfixedCurrentFrameIndexes[h]],this.unfixedCurrentFrameIndexes[h]++;var c=this.unfixedKeyframes[h];u.dataOffset=o;var _=e-c.startTime;for(r=0;r<u.keyframeWidth;)r+=u.interpolationMethod[r](u,r,i,o+r,c.data,_,c.dData,c.duration,c.nextData);o+=u.keyframeWidth}},r(0,e,"loaded",function(){return this._loaded}),i._LinearInterpolation_0=function(t,i,e,a,s,r,n,h,l){return e[a]=s[i]+r*n[i],1},i._QuaternionInterpolation_1=function(t,i,e,a,s,r,n,h,l){var o=0===h?0:r/h;return p.slerpQuaternionArray(s,i,l,i,o,e,a),4},i._AngleInterpolation_2=function(t,i,e,a,s,r,n,h,l){return 0},i._RadiansInterpolation_3=function(t,i,e,a,s,r,n,h,l){return 0},i._Matrix4x4Interpolation_4=function(t,i,e,a,s,r,n,h,l){for(var o=0;16>o;o++,i++)e[a+o]=s[i]+r*n[i];return 16},i._NoInterpolation_5=function(t,i,e,a,s,r,n,h,l){return e[a]=s[i],1},i._uniqueIDCounter=1,i.interpolation=[i._LinearInterpolation_0,i._QuaternionInterpolation_1,i._AngleInterpolation_2,i._RadiansInterpolation_3,i._Matrix4x4Interpolation_4,i._NoInterpolation_5],i.LAYA_ANIMATION_VISION="LAYAANIMATION:1.0.3",i}(o),L=function(t){function i(){i.__super.call(this)}s(i,"laya.ani.GraphicsAni",t);var e=i.prototype;return e.drawSkin=function(t){var i=[t];this._saveToCmd(f._context._drawSkin,i)},i}(u),R=function(t){function i(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.url=null,this.yReverseMatrix=null,this.eventAniArr=[],this._rate=60,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.mRootBone=null,i.__super.call(this),this.mBoneArr=[]}s(i,"laya.ani.bone.Templet",t);var a=i.prototype;return a.loadAni=function(t){this._skBufferUrl=t,e.loader.load(t,c.create(this,this.onComplete),null,"arraybuffer")},a.onComplete=function(){var t=_.getRes(this._skBufferUrl);this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,t)},a.parseData=function(t,i,e){void 0===e&&(e=60),this._mainTexture=t,this._rate=e,this.parse(i,e)},a.buildArmature=function(t){return void 0===t&&(t=0),new E(this,t)},a.parse=function(i,e){t.prototype.parse.call(this,i,e),
this._aniVersion!=B.LAYA_ANIMATION_VISION&&"LAYAANIMATION:1.0.2"!=this._aniVersion&&(console.log("[Error] 版本不一致，请使用IDE版本（1.3.0）重新导出"),this._loaded=!1),this._loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},a._parseTexturePath=function(){var t=0;this._loadList=[];var i,a=new l(this.getPublicExtData()),s=0,r=0,n=0,h=0,o=0,u=0,_=0,p=0,d=0,f=a.getUint8(),x=a.readUTFString(),m=x.split("\n");for(t=0;f>t;t++)i=this._path+m[2*t],x=m[2*t+1],s=a.getFloat32(),r=a.getFloat32(),n=a.getFloat32(),h=a.getFloat32(),d=a.getFloat32(),o=isNaN(d)?0:d,d=a.getFloat32(),u=isNaN(d)?0:d,d=a.getFloat32(),_=isNaN(d)?n:d,d=a.getFloat32(),p=isNaN(d)?h:d,-1==this._loadList.indexOf(i)&&this._loadList.push(i);e.loader.load(this._loadList,c.create(this,this._textureComplete))},a._textureComplete=function(){for(var t,i,e=0,a=this._loadList.length;a>e;e++)i=this._loadList[e],t=this._textureDic[i]=_.getRes(i);this._parsePublicExtData()},a._parsePublicExtData=function(){var t=0,i=0,e=0,a=0,s=0;for(t=0,s=this.getAnimationCount();s>t;t++)this._graphicsCache.push([]);var r,n,h=new l(this.getPublicExtData()),o=0,u=0,c=0,_=0,p=0,f=0,x=0,m=0,g=0,M=h.getUint8(),N=h.readUTFString(),A=N.split("\n");for(t=0;M>t;t++)r=this._mainTexture,n=this._path+A[2*t],N=A[2*t+1],null==this._mainTexture&&(r=this._textureDic[n]),o=h.getFloat32(),u=h.getFloat32(),c=h.getFloat32(),_=h.getFloat32(),g=h.getFloat32(),p=isNaN(g)?0:g,g=h.getFloat32(),f=isNaN(g)?0:g,g=h.getFloat32(),x=isNaN(g)?c:g,g=h.getFloat32(),m=isNaN(g)?_:g,this.subTextureDic[N]=y.create(r,o,u,c,_,-p,-f,x,m);"LAYAANIMATION:1.0.3"==this._aniVersion&&(this._mainTexture=r);var k,U=h.getUint16();for(t=0;U>t;t++)k=[],k.push(h.getUint16()),k.push(h.getUint16()),k.push(h.getUint16()),"LAYAANIMATION:1.0.3"==this._aniVersion&&k.push(h.getUint16()),this.aniSectionDic[t]=k;var B,L,R,E,O=h.getInt16(),Y={};for(t=0;O>t;t++)B=new v,R=h.readUTFString(),E=h.readUTFString(),B.length=h.getFloat32(),"LAYAANIMATION:1.0.3"==this._aniVersion&&(1==h.getByte()&&(B.inheritRotation=!1),1==h.getByte()&&(B.inheritScale=!1)),B.name=R,E&&(L=Y[E],L?L.addChild(B):this.mRootBone=B),Y[R]=B,this.mBoneArr.push(B);var X,W=h.getUint16(),K=h.getUint16(),V=Math.floor(K/W),q=this.srcBoneMatrixArr;for(t=0;V>t;t++)X=new P,X.scX=h.getFloat32(),X.skX=h.getFloat32(),X.skY=h.getFloat32(),X.scY=h.getFloat32(),X.x=h.getFloat32(),X.y=h.getFloat32(),q.push(X),B=this.mBoneArr[t],B.transform=X;var G,z=h.getUint16(),Q=0;for(t=0;z>t;t++){for(G=new b,Q=h.getUint16(),i=0;Q>i;i++)G.boneNames.push(h.readUTFString()),G.boneIndexs.push(h.getInt16());G.name=h.readUTFString(),G.targetBoneName=h.readUTFString(),G.targetBoneIndex=h.getInt16(),G.bendDirection=h.getFloat32(),G.mix=h.getFloat32(),this.ikArr.push(G)}if("LAYAANIMATION:1.0.3"==this._aniVersion){var Z,$=h.getUint16(),j=0;for(t=0;$>t;t++){for(Z=new w,j=h.getUint16(),i=0;j>i;i++)Z.boneIndexs.push(h.getInt16());Z.name=h.getUTFString(),Z.targetIndex=h.getInt16(),Z.rotateMix=h.getFloat32(),Z.translateMix=h.getFloat32(),Z.scaleMix=h.getFloat32(),Z.shearMix=h.getFloat32(),Z.offsetRotation=h.getFloat32(),Z.offsetX=h.getFloat32(),Z.offsetY=h.getFloat32(),Z.offsetScaleX=h.getFloat32(),Z.offsetScaleY=h.getFloat32(),Z.offsetShearY=h.getFloat32(),this.tfArr.push(Z)}var H,J=h.getUint16(),tt=0;for(t=0;J>t;t++){for(H=new T,H.name=h.readUTFString(),tt=h.getUint16(),i=0;tt>i;i++)H.bones.push(h.getInt16());H.target=h.readUTFString(),H.positionMode=h.readUTFString(),H.spacingMode=h.readUTFString(),H.rotateMode=h.readUTFString(),H.offsetRotation=h.getFloat32(),H.position=h.getFloat32(),H.spacing=h.getFloat32(),H.rotateMix=h.getFloat32(),H.translateMix=h.getFloat32(),this.pathArr.push(H)}var it,et,at=h.getInt16(),st=0;for(t=0;at>t;t++){for(st=h.getInt16(),it=[],i=0;st>i;i++)et=new I,et.name=h.getUTFString(),et.intValue=h.getInt32(),et.floatValue=h.getFloat32(),et.stringValue=h.getUTFString(),et.time=h.getFloat32(),it.push(et);this.eventAniArr.push(it)}}var rt,nt,ht=h.getInt16();for(t=0;ht>t;t++)rt=new D,rt.name=h.readUTFString(),rt.parent=h.readUTFString(),rt.attachmentName=h.readUTFString(),rt.srcDisplayIndex=rt.displayIndex=h.getInt16(),rt.templet=this,this.boneSlotDic[rt.name]=rt,nt=this.bindBoneBoneSlotDic[rt.parent],null==nt&&(this.bindBoneBoneSlotDic[rt.parent]=nt=[]),nt.push(rt),this.boneSlotArray.push(rt);var lt,ot,ut,ct=h.readUTFString(),_t=ct.split("\n"),pt=0,dt=h.getUint8(),ft=0,xt=0,mt=0,gt=0,yt=0,Mt=0,vt=0;for(t=0;dt>t;t++){for(lt=new F,lt.name=_t[pt++],ft=h.getUint8(),i=0;ft>i;i++){for(ot=new S,ot.name=_t[pt++],rt=this.boneSlotDic[ot.name],xt=h.getUint8(),e=0;xt>e;e++){if(ut=new C,ut.name=_t[pt++],ut.attachmentName=_t[pt++],ut.transform=new P,ut.transform.scX=h.getFloat32(),ut.transform.skX=h.getFloat32(),ut.transform.skY=h.getFloat32(),ut.transform.scY=h.getFloat32(),ut.transform.x=h.getFloat32(),ut.transform.y=h.getFloat32(),ot.displayArr.push(ut),ut.width=h.getFloat32(),ut.height=h.getFloat32(),ut.type=h.getUint8(),"LAYAANIMATION:1.0.3"==this._aniVersion&&(ut.verLen=h.getUint16()),O=h.getUint16(),O>0)for(ut.bones=[],a=0;O>a;a++){var Dt=h.getUint16();ut.bones.push(Dt)}if(mt=h.getUint16(),mt>0)for(ut.uvs=[],a=0;mt>a;a++)ut.uvs.push(h.getFloat32());if(gt=h.getUint16(),gt>0)for(ut.weights=[],a=0;gt>a;a++)ut.weights.push(h.getFloat32());if(yt=h.getUint16(),yt>0)for(ut.triangles=[],a=0;yt>a;a++)ut.triangles.push(h.getUint16());if(Mt=h.getUint16(),Mt>0)for(ut.vertices=[],a=0;Mt>a;a++)ut.vertices.push(h.getFloat32());if("LAYAANIMATION:1.0.3"==this._aniVersion&&(vt=h.getUint16(),vt>0))for(ut.lengths=[],a=0;vt>a;a++)ut.lengths.push(h.getFloat32())}lt.slotArr.push(ot)}this.skinDic[lt.name]=lt,this.skinDataArray.push(lt)}var It=h.getUint8();1==It&&(this.yReverseMatrix=new d(1,0,0,-1,0,0)),this.showSkinByIndex(this.boneSlotDic,0),this.event("complete",this)},a.getTexture=function(t){var i=this.subTextureDic[t];return null==i?this._mainTexture:i},a.showSkinByIndex=function(t,i){if(0>i&&i>=this.skinDataArray.length)return!1;var e,a,s=0,r=0,n=this.skinDataArray[i];if(n){for(s=0,r=n.slotArr.length;r>s;s++)a=n.slotArr[s],a&&(e=t[a.name],e&&(e.showSlotData(a),"null"!=e.attachmentName?e.showDisplayByName(e.attachmentName):e.showDisplayByIndex(e.displayIndex)));return!0}return!1},a.getSkinIndexByName=function(t){for(var i,e=0,a=this.skinDataArray.length;a>e;e++)if(i=this.skinDataArray[e],i.name==t)return e;return-1},a.getGrahicsDataWithCache=function(t,i){return this._graphicsCache[t][i]},a.setGrahicsDataWithCache=function(t,i,e){this._graphicsCache[t][i]=e},a.destroy=function(){var t;for(var e in this.subTextureDic)t=this.subTextureDic[e],t.destroy();var e;for(e in this._textureDic)t=this._textureDic[e],t.destroy();this.url&&delete i.TEMPLET_DICTIONARY[this.url]},a.getAniNameByIndex=function(t){var i=this.getAnimation(t);return i?i.name:null},r(0,a,"rate",function(){return this._rate}),i.TEMPLET_DICTIONARY=null,i}(B),E=function(t){function i(t,e){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,i.__super.call(this),void 0===e&&(e=0),t&&this.init(t,e)}s(i,"laya.ani.bone.Skeleton",t);var a=i.prototype;return a.init=function(t,i){void 0===i&&(i=0);var e=0,a=0;if(1==i)for(this._graphicsCache=[],e=0,a=t.getAnimationCount();a>e;e++)this._graphicsCache.push([]);if(this._yReverseMatrix=t.yReverseMatrix,this._aniMode=i,this._templet=t,this._player=new U(t.rate),this._player.templet=t,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=t.mBoneArr,this._rootBone=t.mRootBone,this._aniSectionDic=t.aniSectionDic,t.ikArr.length>0)for(this._ikArr=[],e=0,a=t.ikArr.length;a>e;e++)this._ikArr.push(new N(t.ikArr[e],this._boneList));if(t.pathArr.length>0){var s,r;null==this._pathDic&&(this._pathDic={});var n;for(e=0,a=t.pathArr.length;a>e;e++)s=t.pathArr[e],r=new A(s,this._boneList),n=this._boneSlotDic[s.name],n&&(r=new A(s,this._boneList),r.target=n),this._pathDic[s.name]=r}if(t.tfArr.length>0)for(this._tfArr=[],e=0,a=t.tfArr.length;a>e;e++)this._tfArr.push(new k(t.tfArr[e],this._boneList));this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},a.load=function(t,i,a){void 0===a&&(a=0),this._aniPath=t,this._complete=i,this._loadAniMode=a,this._texturePath=t.replace(".sk",".png").replace(".bin",".png"),e.loader.load([{url:t,type:"arraybuffer"},{url:this._texturePath,type:"image"}],c.create(this,this._onLoaded))},a._onLoaded=function(){var t=_.getRes(this._texturePath),i=_.getRes(this._aniPath);if(null!=t&&null!=i){null==R.TEMPLET_DICTIONARY&&(R.TEMPLET_DICTIONARY={});var e;e=R.TEMPLET_DICTIONARY[this._aniPath],e?e.isParseFail?this._parseFail():this._parseComplete():(e=new R,e.url=this._aniPath,R.TEMPLET_DICTIONARY[this._aniPath]=e,e.on("complete",this,this._parseComplete),e.on("error",this,this._parseFail),e.parseData(t,i,60))}},a._parseComplete=function(){var t=R.TEMPLET_DICTIONARY[this._aniPath];t&&(this.init(t,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},a._parseFail=function(){console.log("[Error]:"+this._aniPath+"解析失败")},a._onPlay=function(){this.event("played")},a._onStop=function(){this.event("stopped");var t,i=this._templet.eventAniArr,e=i[this._aniClipIndex];if(e&&this._eventIndex<e.length)for(;this._eventIndex<e.length;this._eventIndex++)t=e[this._eventIndex],this.event("label",t);this._eventIndex=0},a._onPause=function(){this.event("paused")},a._parseSrcBoneMatrix=function(){var t=0,i=0;for(i=this._templet.srcBoneMatrixArr.length,t=0;i>t;t++)this._boneMatrixArray.push(new d);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var e,a,s=this._templet.boneSlotArray;for(t=0,i=s.length;i>t;t++)e=s[t],a=this._bindBoneBoneSlotDic[e.parent],null==a&&(this._bindBoneBoneSlotDic[e.parent]=a=[]),this._boneSlotDic[e.name]=e=e.copy(),a.push(e),this._boneSlotArray.push(e)}},a._update=function(t){if(void 0===t&&(t=!0),!(this._pause||t&&this._indexControl)){var i=e.timer.currTimer;t&&this._player.update(i-this._lastTime),this._lastTime=i,this._aniClipIndex=this._player.currentAnimationClipIndex,this._clipIndex=this._player.currentKeyframeIndex;var a,s=this._templet.eventAniArr,r=s[this._aniClipIndex];if(r&&this._eventIndex<r.length&&(a=r[this._eventIndex],this._player.currentPlayTime>a.time&&(this.event("label",a),this._eventIndex++)),-1!=this._aniClipIndex){var n;if(0==this._aniMode){if(n=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics=n)}else if(1==this._aniMode&&(n=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)))return void(this.graphics=n);this._createGraphics()}}},a._createGraphics=function(){var t;0==this._aniMode||1==this._aniMode?this.graphics=new L:this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=new L,t=this.graphics;var i=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._clipIndex,this._player.currentFrameTime);var e,a,s,r,n=this._aniSectionDic[this._aniClipIndex],h=0,o=0,u=0,c=0,_=0,p=this._templet.srcBoneMatrixArr.length;for(o=0,_=n[0];p>o;o++)r=this._boneList[o],s=this._templet.srcBoneMatrixArr[o],r.resultTransform.scX=s.scX*this._curOriginalData[h++],r.resultTransform.skX=s.skX+this._curOriginalData[h++],r.resultTransform.skY=s.skY+this._curOriginalData[h++],r.resultTransform.scY=s.scY*this._curOriginalData[h++],r.resultTransform.x=s.x+this._curOriginalData[h++],r.resultTransform.y=s.y+this._curOriginalData[h++];var f,x={},m={};for(_+=n[1];_>o;o++)f=i[o],x[f.name]=this._curOriginalData[h++],m[f.name]=this._curOriginalData[h++],this._curOriginalData[h++],this._curOriginalData[h++],this._curOriginalData[h++],this._curOriginalData[h++];var g={},y={};for(_+=n[2];_>o;o++)f=i[o],g[f.name]=this._curOriginalData[h++],y[f.name]=this._curOriginalData[h++],this._curOriginalData[h++],this._curOriginalData[h++],this._curOriginalData[h++];if(this._pathDic){var M;for(_+=n[3];_>o;o++)if(f=i[o],M=this._pathDic[f.name]){var v=new l(f.extenData);switch(v.getByte()){case 1:M.position=this._curOriginalData[h++];break;case 2:M.spacing=this._curOriginalData[h++];break;case 3:M.rotateMix=this._curOriginalData[h++],M.translateMix=this._curOriginalData[h++]}}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(d.TEMP.identity()),this._ikArr){var D;for(o=0,_=this._ikArr.length;_>o;o++)D=this._ikArr[o],g.hasOwnProperty(D.name)&&(D.bendDirection=g[D.name]),y.hasOwnProperty(D.name)&&(D.mix=y[D.name]),D.apply()}if(this._pathDic)for(var I in this._pathDic)M=this._pathDic[I],M.apply(this._boneList,t);if(this._tfArr){var N;for(o=0,c=this._tfArr.length;c>o;o++)N=this._tfArr[o],N.apply()}for(o=0,c=this._boneList.length;c>o;o++)if(r=this._boneList[o],a=this._bindBoneBoneSlotDic[r.name],r.resultMatrix.copyTo(this._boneMatrixArray[o]),a)for(u=0,_=a.length;_>u;u++)e=a[u],e&&e.setParentMatrix(r.resultMatrix);var b=NaN,A=NaN;for(o=0,_=this._boneSlotArray.length;_>o;o++)e=this._boneSlotArray[o],b=x[e.name],A=m[e.name],isNaN(A)||(t.save(),t.alpha(A)),isNaN(b)||e.showDisplayByIndex(b),e.draw(t,this._boneMatrixArray,2==this._aniMode),isNaN(A)||t.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,this._clipIndex,t):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,this._clipIndex,t)},a.getAnimNum=function(){return this._templet.getAnimationCount()},a.getAniNameByIndex=function(t){return this._templet.getAniNameByIndex(t)},a.getSlotByName=function(t){return this._boneSlotDic[t]},a.showSkinByName=function(t){this.showSkinByIndex(this._templet.getSkinIndexByName(t))},a.showSkinByIndex=function(t){this._templet.showSkinByIndex(this._boneSlotDic,t)&&(this._skinIndex=t),this._clearCache()},a.showSlotSkinByIndex=function(t,i){if(0!=this._aniMode){var e=this.getSlotByName(t);e&&e.showDisplayByIndex(i),this._clearCache()}},a.setSlotSkin=function(t,i){if(0!=this._aniMode){var e=this.getSlotByName(t);e&&e.replaceSkin(i),this._clearCache()}},a._clearCache=function(){if(1==this._aniMode)for(var t=0,i=this._graphicsCache.length;i>t;t++)this._graphicsCache[t].length=0},a.play=function(t,i,a){void 0===a&&(a=!0),this._indexControl=!1;var s=-1,r=NaN;if(r=i?Number.MAX_VALUE:0,"string"==typeof t)for(var n=0,l=this._templet.getAnimationCount();l>n;n++){var o=this._templet.getAnimation(n);if(o&&t==o.name){s=n;break}}else s=t;s>-1&&s<this.getAnimNum()&&(a||this._pause||this._currAniIndex!=s)&&(this._currAniIndex=s,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(s)),this._player.play(s,this._player.playbackRate,r),this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=h.now(),e.stage.frameLoop(1,this,this._update,null,!0)))},a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),e.timer.clear(this,this._update))},a.playbackRate=function(t){this._player&&(this._player.playbackRate=t)},a.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),e.timer.clear(this,this._update))},a.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=h.now(),e.stage.frameLoop(1,this,this._update,null,!0))},a._getGrahicsDataWithCache=function(t,i){return this._graphicsCache[t][i]},a._setGrahicsDataWithCache=function(t,i,e){this._graphicsCache[t][i]=e},a.destroy=function(i){void 0===i&&(i=!0),t.prototype.destroy.call(this,i),this._templet=null,this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,e.timer.clear(this,this._update)},r(0,a,"index",function(){return this._index},function(t){this.player&&(this._index=t,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),r(0,a,"player",function(){return this._player}),r(0,a,"url",function(){return this._aniPath},function(t){this.load(t)}),r(0,a,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),i}(m);(function(t){function i(t){this._start=0,this._Pos=0,this._data=null,this._curIndex=0,this._preIndex=0,this._playIndex=0,this._playing=!1,this._ended=!0,this._count=0,this._ids=null,this._loadedImage={},this._idOfSprite=null,this._parentMovieClip=null,this._movieClipList=null,this._labels=null,this.basePath=null,this._atlasPath=null,this._url=null,this._isRoot=!1,this.interval=30,this.loop=!1,i.__super.call(this),this._ids={},this._idOfSprite=[],this._reset(),this._playing=!1,this._parentMovieClip=t,t?(this._isRoot=!1,this._movieClipList=t._movieClipList,this._movieClipList.push(this)):(this._movieClipList=[this],this._isRoot=!0)}s(i,"laya.ani.swf.MovieClip",t);var a=i.prototype;return a.destroy=function(i){void 0===i&&(i=!0),this._clear(),t.prototype.destroy.call(this,i)},a._setDisplay=function(i){t.prototype._setDisplay.call(this,i),this._isRoot&&this._$3__onDisplay()},a._$3__onDisplay=function(){this._displayedInStage?e.timer.loop(this.interval,this,this.updates,null,!0):e.timer.clear(this,this.updates)},a.updates=function(){if(!this._parentMovieClip){var t=0,i=0;for(i=this._movieClipList.length,t=0;i>t;t++)this._movieClipList[t]&&this._movieClipList[t]._update()}},a.addLabel=function(t,i){this._labels||(this._labels={}),this._labels[i]=t},a.removeLabel=function(t){if(t){if(!this._labels)for(var i in this._labels)if(this._labels[i]===t){delete this._labels[i];break}}else this._labels=null},a._update=function(){if(this._data&&this._playing){if(this._playIndex++,this._playIndex>=this._count){if(!this.loop)return this._playIndex--,void this.stop();this._playIndex=0}this._parse(this._playIndex),this._labels&&this._labels[this._playIndex]&&this.event("label",this._labels[this._playIndex])}},a.stop=function(){this._playing=!1},a.gotoAndStop=function(t){this.index=t,this.stop()},a._clear=function(){if(this.stop(),this._idOfSprite.length=0,!this._parentMovieClip){e.timer.clear(this,this.updates);var t=0,i=0;for(i=this._movieClipList.length,t=0;i>t;t++)this._movieClipList[t]!=this&&this._movieClipList[t]._clear();this._movieClipList.length=0}var a;for(a in this._loadedImage)this._loadedImage[a]&&(_.clearRes(a),this._loadedImage[a]=!1);this.removeChildren(),this.graphics=null,this._parentMovieClip=null},a.play=function(t,i){void 0===t&&(t=0),void 0===i&&(i=!0),this.loop=i,this._playing=!0,this._data&&this._displayFrame(t)},a._displayFrame=function(t){void 0===t&&(t=-1),-1!=t&&(this._curIndex>t&&this._reset(),this._parse(t))},a._reset=function(t){void 0===t&&(t=!0),t&&1!=this._curIndex&&this.removeChildren(),this._preIndex=this._curIndex=-1,this._Pos=this._start},a._parse=function(t){var e,a,s,r=0,n=0,h=0,l=0,o=!1,u=this._idOfSprite,c=this._data;for(this._ended&&this._reset(),c.pos=this._Pos,this._ended=!1,this._playIndex=t,this._curIndex>t&&t<this._preIndex&&(this._reset(!0),c.pos=this._Pos);this._curIndex<=t&&!this._ended;)switch(n=c.getUint16()){case 12:if(r=c.getUint16(),h=this._ids[c.getUint16()],this._Pos=c.pos,c.pos=h,0==(l=c.getUint8())){var _=c.getUint16();if(a=u[r],!a){a=u[r]=new m;var p=new m;p.loadImage(this.basePath+_+".png"),this._loadedImage[this.basePath+_+".png"]=!0,a.addChild(p),p.size(c.getFloat32(),c.getFloat32());var f=c._getMatrix();p.transform=f}a.alpha=1}else 1==l&&(e=u[r],e||(u[r]=e=new i(this),e.interval=this.interval,e._ids=this._ids,e.basePath=this.basePath,e._setData(c,h),e._initState(),e.play(0)),e.alpha=1);c.pos=this._Pos;break;case 3:this.addChild(u[c.getUint16()]).zOrder=c.getUint16(),o=!0;break;case 4:u[c.getUint16()].removeSelf();break;case 5:u[c.getUint16()][i._ValueList[c.getUint16()]]=c.getFloat32();break;case 6:u[c.getUint16()].visible=c.getUint8()>0;break;case 7:a=u[c.getUint16()];var x=a.transform||d.create();x.setTo(c.getFloat32(),c.getFloat32(),c.getFloat32(),c.getFloat32(),c.getFloat32(),c.getFloat32()),a.transform=x;break;case 8:u[c.getUint16()].setPos(c.getFloat32(),c.getFloat32());break;case 9:u[c.getUint16()].setSize(c.getFloat32(),c.getFloat32());break;case 10:u[c.getUint16()].alpha=c.getFloat32();break;case 11:u[c.getUint16()].setScale(c.getFloat32(),c.getFloat32());break;case 98:s=c.getString(),this.event(s),"stop"==s&&this.stop();break;case 99:this._curIndex=c.getUint16(),o&&this.updateZOrder();break;case 100:this._count=this._curIndex+1,this._ended=!0,this._playing&&(this.event("enterframe"),this.event("end"),this.event("complete")),this._reset(!1)}this._playing&&!this._ended&&this.event("enterframe"),this._Pos=c.pos},a._setData=function(t,i){this._data=t,this._start=i+3},a.load=function(t,i,a){void 0===i&&(i=!1),this._url=t=M.formatURL(t),i&&(this._atlasPath=a?a:t.split(".swf")[0]+".json"),this.stop(),this._clear(),this._movieClipList=[this];var s;s=[{url:t,type:"arraybuffer"}],this._atlasPath&&s.push({url:this._atlasPath,type:"atlas"}),e.loader.load(s,c.create(this,this._onLoaded))},a._onLoaded=function(){this.basePath=this._atlasPath?_.getAtlas(this._atlasPath).dir:this._url.split(".swf")[0]+"/image/";var t;t=_.getRes(this._url),t&&this._initData(t)},a._initState=function(){this._reset(),this._ended=!1;var t=this._playing;for(this._playing=!1,this._curIndex=0;!this._ended;)this._parse(++this._curIndex);this._playing=t},a._initData=function(t){this._data=new l(t);var i=0,a=this._data.getUint16();for(i=0;a>i;i++)this._ids[this._data.getInt16()]=this._data.getInt32();this.interval=1e3/this._data.getUint16(),this._setData(this._data,this._ids[32767]),this._initState(),this.play(0),this.event("loaded"),this._parentMovieClip||e.timer.loop(this.interval,this,this.updates,null,!0)},r(0,a,"index",function(){return this._playIndex},function(t){this._playIndex=t,this._data&&this._displayFrame(this._playIndex),this._labels&&this._labels[t]&&this.event("label",this._labels[t])}),r(0,a,"url",null,function(t){this.load(t)}),r(0,a,"count",function(){return this._count}),r(0,a,"playing",function(){return this._playing}),i._ValueList=["x","y","width","height","scaleX","scaleY","rotation","alpha"],i})(m)}(window,document,Laya);